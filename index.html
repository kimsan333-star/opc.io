<!doctype html>
<html lang="ja">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>OPCポータル</title>
	<link rel="stylesheet" href="./css/styles.css" />
</head>
<body>
	<main class="app" role="application">
		<!-- 1) Header -->
		<header class="topbar" aria-label="ヘッダー">
			<div class="brand">
				<img class="brand__logo" src="./img/openup.jpg" alt="OPCポータル">
				<span class="brand__url">portal.openup-construction.co.jp</span>
			</div>
			<button class="menu-btn" id="btnMenu" aria-haspopup="dialog" aria-expanded="false" aria-controls="menuSheet">
				<img src="data:image/svg+xml;utf8,
					<svg xmlns='http://www.w3.org/2000/svg' width='20' height='20'>
						<rect y='3' width='20' height='2' fill='%23777'/>
						<rect y='9' width='20' height='2' fill='%23777'/>
						<rect y='15' width='20' height='2' fill='%23777'/>
					</svg>" alt="">
			</button>
		</header>

		<!-- 2) Date strip -->
		<section class="datestrip" aria-label="日付と時刻">
			<div class="datestrip__date">
				<img src="data:image/svg+xml;utf8,
					<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18'>
						<rect x='1' y='3' width='16' height='14' rx='2' ry='2' fill='%23ffffff' stroke='%23ed6c00'/>
						<rect x='1' y='6' width='16' height='1.5' fill='%23ed6c00'/>
					</svg>" alt="" width="18" height="18">
				<span id="todayText"></span><span id="clockText"></span>
				<!--div class="datestrip__time" id="clockText" aria-live="polite"></div-->
			</div>
			
		</section>

		<!-- 3) Main wrapper（←ここが1frの中身） -->
		<div class="main">
			<!-- 勤怠タイル -->
			<section class="section section--att" aria-label="勤怠メニュー">
				<div class="tiles">
					<div class="tile" role="button" tabindex="0" aria-label="出勤">
						<img alt="" src="./img/start.jpg"><div class="tile__label">定時出勤</div>
					</div>
					<div class="tile" role="button" tabindex="0" aria-label="退勤する">
						<img alt="" src="./img/end.jpg"><div class="tile__label">定時退勤</div>
					</div>
					<div class="tile" role="button" tabindex="0" aria-label="勤怠入力">
						<img alt="" src="./img/kintai.jpg"><div class="tile__label">勤怠入力･変更</div>
					</div>
				</div>
			</section>

			<!-- 次回指定労働日（テキスト／中央寄せ） -->
			<p class="nextday">次回指定労働日：<strong id="nextWorkday">2025年9月13日 (土)</strong></p>

			<!-- アプリメニュー（均等配置） -->
			<section class="section" aria-label="アプリメニュー">
				<div class="tiles">
					<div class="tile" aria-label="お知らせ">
						<span class="badge" id="badge-notice" data-count="3" hidden>0</span>
						<img alt="" src="./img/info.jpg"><div class="tile__label">お知らせ</div>
					</div>
					<div class="tile" aria-label="給与明細">
						<img alt="" src="./img/kyuyo.jpg"><div class="tile__label">給与明細</div>
					</div>
					<div class="tile" aria-label="書類回収・送信">
						<img alt="" src="./img/denshi.jpg"><div class="tile__label">電子書類</div>
					</div>
					<div class="tile" aria-label="福利厚生">
						<img alt="" src="./img/benesta.jpg"><div class="tile__label">福利厚生</div>
					</div>
					<div class="tile" aria-label="TUNAG">
						<img alt="" src="./img/tunag.jpg"><div class="tile__label">TUNAG</div>
					</div>
					<div class="tile" aria-label="ゆめのこFAQ!">
						<img alt="" src="./img/faq.jpg"><div class="tile__label">ゆめのこFAQ!</div>
					</div>
					<div class="tile" aria-label="経費清算">
						<img alt="" src="./img/receipt.jpg"><div class="tile__label">経費･立替金<br>清算</div>
					</div>
					<div class="tile" aria-label="交通費清算">
						<img alt="" src="./img/train.jpg"><div class="tile__label">交通費清算</div>
					</div>
					<div class="tile" aria-label="各種申請">
						<img alt="" src="./img/shinsei.jpg"><div class="tile__label">各種申請</div>
					</div>
					<div class="tile" aria-label="">
						<img alt="" src="./img/green.jpg"><div class="tile__label">アイコン10</div>
					</div>
					<div class="tile" aria-label="">
						<img alt="" src="./img/purple.jpg"><div class="tile__label">アイコン11</div>
					</div>
					<div class="tile" aria-label="">
						<img alt="" src="./img/blue.jpg"><div class="tile__label">アイコン12</div>
					</div>
				</div>
			</section>
			<div class="footer-note">Copyright © Open Up Construction Co.,Ltd. All rights reserved.</div>
		</div> <!-- /.main -->
	</main>

	<!-- Overlay Menu -->
	<div class="overlay" id="overlay" aria-hidden="true">
		<div class="sheet" id="menuSheet" role="dialog" aria-modal="true" aria-labelledby="menuTitle">
			<header id="menuTitle">メニュー</header>
			<ul>
				<li>
					<button class="menuitem" type="button">
						<img alt="" src="data:image/svg+xml;utf8,
							<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18'>
								<circle cx='9' cy='9' r='8' stroke='%23ed6c00' fill='none'/>
								<path d='M9 5v6' stroke='%23ed6c00'/>
								<circle cx='9' cy='13' r='1' fill='%23ed6c00'/>
							</svg>">パスワード設定
					</button>
				</li>
				<li>
					<button class="menuitem" type="button">
						<img alt="" src="data:image/svg+xml;utf8,
							<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18'>
								<path d='M3 3h8v12H3z' fill='none' stroke='%23ed6c00'/>
								<path d='M11 9h5' stroke='%23ed6c00'/>
								<path d='M13 7l3 2-3 2' fill='%23ed6c00'/>
							</svg>">ログアウト
					</button>
				</li>
			</ul>
		</div>
	</div>

	<!-- 共通関数 -->
	<script src="./js/utils.js"></script>

	<!-- ページ固有の初期化 -->
	<script>
		// 日付・時刻
		const todayText = document.getElementById('todayText');
		const clockText = document.getElementById('clockText');
		function tick(){
			const now = new Date();
			todayText.textContent = window.formatDateJP(now);
			clockText.textContent = window.formatTime(now);
		}
		tick();
		setInterval(tick, 10_000);

		// バッジ初期表示：?notice= > data-count の優先順
		document.addEventListener('DOMContentLoaded', () => {
			const qs = new URLSearchParams(location.search);
			const qsNotice = qs.get('notice');
			const el = document.getElementById('badge-notice');
			const initial = qsNotice !== null
				? parseInt(qsNotice, 10) || 0
				: parseInt(el?.dataset.count || '0', 10);
			window.updateBadge('badge-notice', initial);
		});

		// オーバーレイメニュー
		const btnMenu = document.getElementById('btnMenu');
		const overlay = document.getElementById('overlay');
		const sheet = document.getElementById('menuSheet');
		function openMenu(){
			overlay.setAttribute('aria-hidden','false');
			btnMenu.setAttribute('aria-expanded','true');
			setTimeout(()=> sheet.querySelector('.menuitem')?.focus(), 0);
		}
		function closeMenu(){
			overlay.setAttribute('aria-hidden','true');
			btnMenu.setAttribute('aria-expanded','false');
			btnMenu.focus();
		}
		btnMenu.addEventListener('click', openMenu);
		overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeMenu(); });
		document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && overlay.getAttribute('aria-hidden')==='false') closeMenu(); });
	</script>
</body>
</html>
